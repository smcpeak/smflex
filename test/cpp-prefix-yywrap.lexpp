/* cpp-prefix-yywrap.lexpp */
/* C++ scanner using %option prefix and %option yywrap. */

%option c++
%option main
%option prefix="MyLexer"
%option yywrap

%{
#include <fstream>           // ifstream
using std::ifstream;
%}

%%
username           cout << "USERNAME";

%%

/* Non-NULL once we have read the second input. */
static istream *secondFile = NULL;

int MyLexerFlexLexer::yywrap()
{
  if (!secondFile) {
    secondFile = new ifstream("cppscan-yywrap.input2");
    if (secondFile->fail()) {
      perror("new ifstream(cppscan-yywrap.input2)");
      delete secondFile;
      exit(2);
    }

    switch_streams(secondFile);

    /* Not done, keep going. */
    return 0;
  }
  else {
    delete secondFile;

    /* All done. */
    return 1;
  }
}


/* EOF */
